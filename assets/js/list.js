var list = [{
        "name": "Dorinku",
        "classname": "dorinku",
        "place_id": "ChIJ7entTw4ioFMRJEb9P-xsU2M"
    },
    {
        "name": "Rostizado",
        "classname": "rostizado",
        "place_id": "ChIJJaBKPkkioFMRzuMRISLlVNc"
    },
    {
        "name": "Bar Bricco",
        "classname": "bar-bricco",
        "place_id": "ChIJzdLZwEcioFMROKJE1fWtiYw"
    }/*,
    {
        "name": "Cafe Mosaics",
        "classname": "cafe-mosaics",
        "place_id": "ChIJ6YXslhwioFMRKiBMjNaa_2Y"
    },
    {
        "name": "Hanjan",
        "classname": "Hanjan",
        "place_id": "ChIJ6fqtHSwfoFMR7CEvWZoiuzA"
    },
    {
        "name": "Baijiu Bar",
        "classname": "Baijiu Bar",
        "place_id": "ChIJKcXdPUkioFMRBspqKB4GLqo"
    },
    {
        "name": "Scoop N' Roll",
        "classname": "Scoop N' Roll",
        "place_id": "ChIJK-HZ_yUfoFMRVQNRiPtg-yE"
    },
    {
        "name": "Mayday Dogs",
        "classname": "Mayday Dogs",
        "place_id": "ChIJKcXdPUkioFMRqIerQNhliKw"
    },
    {
        "name": "The Holy Roller",
        "classname": "The Holy Roller",
        "place_id": "ChIJPwFzNA4ioFMRWBv9alBJ1Vw"
    },
    {
        "name": "Have Mercy Southern Table & Bar",
        "classname": "Have Mercy Southern Table & Bar",
        "place_id": "ChIJYeWoMw4ioFMR0_Rrlxzlc04"
    },
    {
        "name": "Canteen",
        "classname": "Canteen",
        "place_id": "ChIJgXmLeNMjoFMR8UurMIGPScM"
    },
    {
        "name": "Artisan Resto-Cafe",
        "classname": "Artisan Resto-Cafe",
        "place_id": "ChIJj8y9RBsioFMRUOQXLACd-HE"
    },
    {
        "name": "New York Bagel Cafe",
        "classname": "New York Bagel Cafe",
        "place_id": "ChIJz-Jn3BEioFMRrmPLB9LnyVs"
    },
    {
        "name": "Under The High Wheel",
        "classname": "Under The High Wheel",
        "place_id": "ChIJC8eyWg4ioFMREEvBaBVDbvY"
    },
    {
        "name": "Urban Diner",
        "classname": "Urban Diner",
        "place_id": "ChIJT7wcBysioFMR54-_-DnmDhw"
    },
    {
        "name": "Café Linnea",
        "classname": "Café Linnea",
        "place_id": "ChIJmztXI88joFMRKxfHzlHJte0"
    },
    {
        "name": "Cafe Bicyclette",
        "classname": "Cafe Bicyclette",
        "place_id": "ChIJ1byBhnAioFMR9L65k14J150"
    },
    {
        "name": "District Café & Bakery",
        "classname": "District Café & Bakery",
        "place_id": "ChIJk7ry6jkioFMRcA8fOkgCzeY"
    },
    {
        "name": "SPLASH POKE",
        "classname": "SPLASH POKE",
        "place_id": "ChIJf5EkaTcioFMRg7sAT4-Ikdg"
    },
    {
        "name": "'Ono Poke Co.",
        "classname": "'Ono Poke Co",
        "place_id": "ChIJQSNNdkgioFMR0m8X7S3KU6w"
    },
    {
        "name": "Pip",
        "classname": "Pip",
        "place_id": "ChIJ3YuZ3g8ioFMRdWTFgAN2QyA"
    },
    {
        "name": "Uccelino",
        "classname": "Uccelino",
        "place_id": ""
    },
    {
        "name": "Malt & Mortar",
        "classname": "Malt & Mortar",
        "place_id": ""
    },
    {
        "name": "Tres Carnales Taqueria",
        "classname": "Tres Carnales Taqueria",
        "place_id": ""
    },
    {
        "name": "Tzin Wine & Tapas Ltd",
        "classname": "Tzin Wine & Tapas Ltd",
        "place_id": ""
    },
    {
        "name": "Monument",
        "classname": "Monument",
        "place_id": ""
    },
    {
        "name": "XO Bistro + Bar",
        "classname": "XO Bistro + Bar",
        "place_id": ""
    },
    {
        "name": "Japonais Bistro",
        "classname": "Japonais Bistro",
        "place_id": ""
    },
    {
        "name": "Snowy dessert",
        "classname": "Snowy dessert",
        "place_id": ""
    },
    {
        "name": "Let eat snow",
        "classname": "Let eat snow",
        "place_id": ""
    },
    {
        "name": "Farrow",
        "classname": "Farrow",
        "place_id": ""
    },
    {
        "name": "Rg rd",
        "classname": "Rg rd",
        "place_id": ""
    },
    {
        "name": "Tiffin",
        "classname": "Tiffin",
        "place_id": ""
    },
    {
        "name": "High voltage food & coffee bar",
        "classname": "High voltage food & coffee bar",
        "place_id": ""
    },
    {
        "name": "The tea girl",
        "classname": "The tea girl",
        "place_id": ""
    },
    {
        "name": "Doughnut party",
        "classname": "Doughnut party",
        "place_id": ""
    },
    {
        "name": "Northern chicken",
        "classname": "Northern chicken",
        "place_id": ""
    },
    {
        "name": "De Dutch",
        "classname": "De Dutch",
        "place_id": ""
    },
    {
        "name": "Parlour",
        "classname": "Parlour",
        "place_id": ""
    },
    {
        "name": "Urbano pizza",
        "classname": "Urbano pizza",
        "place_id": ""
    },
    {
        "name": "Sugarbowl",
        "classname": "Sugarbowl",
        "place_id": ""
    },
    {
        "name": "High level diner",
        "classname": "High level diner",
        "place_id": ""
    },
    {
        "name": "Love Pizza",
        "classname": "Love Pizza",
        "place_id": ""
    },
    {
        "name": "Blaze pizza",
        "classname": "Blaze pizza",
        "place_id": ""
    },
    {
        "name": "Block 1912",
        "classname": "Block 1912",
        "place_id": ""
    },
    {
        "name": "It dog",
        "classname": "It dog",
        "place_id": ""
    },
    {
        "name": "Rosso",
        "classname": "Rosso",
        "place_id": ""
    },
    {
        "name": "Izakaya tomo",
        "classname": "Izakaya tomo",
        "place_id": ""
    },
    {
        "name": "Ohana donuterie",
        "classname": "Ohana donuterie",
        "place_id": ""
    },
    {
        "name": "Rebel food & drink",
        "classname": "Rebel food & drink",
        "place_id": ""
    },
    {
        "name": "Dadeo's",
        "classname": "Dadeo's",
        "place_id": ""
    },
    {
        "name": "Cibo bistro",
        "classname": "Cibo bistro",
        "place_id": ""
    },
    {
        "name": "Red ox inn",
        "classname": "Red ox inn",
        "place_id": ""
    },
    {
        "name": "Huma",
        "classname": "Huma",
        "place_id": ""
    },
    {
        "name": "Solstice",
        "classname": "Solstice",
        "place_id": ""
    },
    {
        "name": "Leva cafe",
        "classname": "Leva cafe",
        "place_id": ""
    },
    {
        "name": "Bistro praha",
        "classname": "Bistro praha",
        "place_id": ""
    },
    {
        "name": "Thanh thanh",
        "classname": "Thanh thanh",
        "place_id": ""
    },
    {
        "name": "Syphay",
        "classname": "Syphay",
        "place_id": ""
    },
    {
        "name": "Nomchuks",
        "classname": "Nomchuks",
        "place_id": ""
    },
    {
        "name": "Parkallen pizza/restaurant",
        "classname": "Parkallen pizza/restaurant",
        "place_id": ""
    },
    {
        "name": "Packrat louie",
        "classname": "Packrat louie",
        "place_id": ""
    },
    {
        "name": "Beer revolution",
        "classname": "Beer revolution",
        "place_id": ""
    },
    {
        "name": "Pazzo pazzo",
        "classname": "Pazzo pazzo",
        "place_id": ""
    },
    {
        "name": "Jacks pizza cafe",
        "classname": "Jacks pizza cafe",
        "place_id": ""
    },
    {
        "name": "Stone & wheel",
        "classname": "Stone & wheel",
        "place_id": ""
    },
    {
        "name": "Little brick",
        "classname": "Little brick",
        "place_id": ""
    },
    {
        "name": "Blue plate diner",
        "classname": "Blue plate diner",
        "place_id": ""
    },
    {
        "name": "Gama cafe",
        "classname": "Gama cafe",
        "place_id": ""
    },
    {
        "name": "Woodrack cafe",
        "classname": "Woodrack cafe",
        "place_id": ""
    },
    {
        "name": "Art of cake",
        "classname": "Art of cake",
        "place_id": ""
    },
    {
        "name": "Duchess",
        "classname": "Duchess",
        "place_id": ""
    },
    {
        "name": "Lockstock coffee",
        "classname": "Lockstock coffee",
        "place_id": ""
    },
    {
        "name": "La boule",
        "classname": "La boule",
        "place_id": ""
    },
    {
        "name": "Moth cafe",
        "classname": "Moth cafe",
        "place_id": ""
    },
    {
        "name": "Crum coffee bar",
        "classname": "Crum coffee bar",
        "place_id": ""
    },
    {
        "name": "Bru coffee + beerhouse ",
        "classname": "Bru coffee + beerhouse ",
        "place_id": ""
    },
    {
        "name": "Square 1 coffee",
        "classname": "Square 1 coffee",
        "place_id": ""
    },
    {
        "name": "Monument coffee bar",
        "classname": "Monument coffee bar",
        "place_id": ""
    },
    {
        "name": "Credo coffee",
        "classname": "Credo coffee",
        "place_id": ""
    },
    {
        "name": "High level diner",
        "classname": "High level diner",
        "place_id": ""
    },
    {
        "name": "Workshop eatery",
        "classname": "Workshop eatery",
        "place_id": ""
    }*/
];

// http://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle#The_modern_algorithm
// var shuffledlist = shuffle(list);
function shuffle(sourceArray) {
    for (var i = 0; i < 11; i++) {
        var j = i + Math.floor(Math.random() * (sourceArray.length - i));

        var temp = sourceArray[j];
        sourceArray[j] = sourceArray[i];
        sourceArray[i] = temp;
    }
    return sourceArray;
}

var featuredPlace = list[0];

// Toggle the filterview on mobile when it's pressed 
toggleMobileNavView = function () {
    // $(window).scrollTop() < $("#sticky-anchor").offset().top && !$("#mobile-nav").hasClass("open") && $("body,html").scrollTop($("#sticky-anchor").offset().top + 1), 
    $("#mobile-nav").toggleClass("open")
}
$("#mobile-nav").on("click", ".toggle-zone", toggleMobileNavView);
$("#mobile-nav").on("click", ".toggle-close", toggleMobileNavView);

// Make the filterview button stick to the top of the page when scrolling down
var stickyAnchorPlacement = false; 
function toggleFixedMobileNavButton() {
    $("body").toggleClass("filter-fixed"); 
    stickyAnchorPlacement = !stickyAnchorPlacement; 
    $("#sticky-phantom").toggle(); 
}
$("body").on('scroll', function () {
    if ($("#mobile-nav").css("display") != "none") {
        if (stickyAnchorPlacement && $("#sticky-anchor").offset().top > 0) toggleFixedMobileNavButton();
        if (!stickyAnchorPlacement && $("#sticky-anchor").offset().top < 0) toggleFixedMobileNavButton();
    }
})

// Make search bar filter on text input
function filterCuisineOptions() {
    var input, filter, ul, li, a, i;
    filter = $(".cuisine-toggle input").val().toUpperCase();
    a = $(".cuisine-toggle .dropdown-content.cuisineList a").get();
    for (i = 0; i < a.length; i++) {
        if (a[i].innerHTML.toUpperCase().indexOf(filter) > -1) {
            a[i].style.display = "";
        } else {
            a[i].style.display = "none";
        }
    }
}
function toggleCuisineList(dir) {
    setTimeout(() => {
        $(".cuisineList.dropdown-content").toggleClass("show"); 
    }, 250);
}

// $("#mobile-nav").on("click", ".person", mobileSort);
// $("#mobile-nav").on("click", ".filter-position a", mobileFilter);
// $("#mobile-nav .nav-actions").on("click", ".size-toggle a", mobileChangeSize);

function changeSize(s) {
    $(".size-toggle .active").removeClass("active"); 
    $("." + s.name).addClass("active");
    $("body").removeClass("small medium large").addClass(s.class); 
}

function toggleCard(param) {
    var card = param.parentElement.parentElement.parentElement; 
    if (card.className.includes(" expanded-card")) {
        card.className = card.className.replace(" expanded-card", '');
    } else {
        card.className += " expanded-card";
    }
}

function filterType(t) {
    // show that the filter is active
    $(".type-toggle .active").removeClass("active");
    $("." + t.name).addClass("active");

    var newdata = alldata.filter(function (itm) {
        if (itm.type == null) { return false }
        return itm.type.toUpperCase() == t.class.toUpperCase()
    })
    $('#list-places').html(template(newdata))
}

function filterCuisine(t) {
    // show that the filter is active
    $(".cuisine-toggle .active").removeClass("active");
    $("." + t.elementname).addClass("active");

    // add class to item-list 
    $('#item-list').removeClass("asian bakery barfood breaky french halal indian italian latin mediterranean middleeast");
    if (t.elementname != "filter-all") {
        $("#item-list").addClass("filtered " + t.class)
        $(".cuisine-toggle input").val(t.name);
        $(".cuisine-toggle input").addClass("active"); 
    } else {
        $(".cuisine-toggle input").val("");
        $(".cuisine-toggle input").removeClass("active");
    }
    
    // filter list items
    filterListItems();
}

function filterListItems() {
    // make classList
    classList = new Set($("#item-list").attr("class").split(" "));
    classList.delete("grid"); 
    classList.delete("filtered"); 

    // remove filtered if there aren't any other classes
    if (classList.size == 0) {
        $("#item-list").removeClass("filtered"); 
        $(".card-item").each(function () {
            $(this).removeClass("filtered-in filtered-out"); 
        })
    }

    $(".card-item").each(function() {
        $(this).removeClass("filtered-in"); 
        filteredin = true; 
        classList.forEach(classfilter => {
            if (!$(this).hasClass(classfilter)) {
                filteredin = false; 
            }
        });
        if (filteredin) {
            $(this).addClass("filtered-in")
        }
    })
}